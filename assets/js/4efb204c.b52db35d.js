"use strict";(self.webpackChunkapi_dokumentasjon=self.webpackChunkapi_dokumentasjon||[]).push([[135],{3905:(e,t,a)=>{a.d(t,{Zo:()=>o,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),m=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):k(k({},t),e)),a},o=function(e){var t=m(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),p=m(a),u=r,g=p["".concat(s,".").concat(u)]||p[u]||d[u]||l;return a?n.createElement(g,k(k({ref:t},o),{},{components:a})):n.createElement(g,k({ref:t},o))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,k=new Array(l);k[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,k[1]=i;for(var m=2;m<l;m++)k[m]=a[m];return n.createElement.apply(null,k)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},2761:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>k,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>m});var n=a(7462),r=(a(7294),a(3905));const l={title:"Samtykke",slug:"/samtykke",folder:"om",sidebar:"mydoc_sidebar",datatable:!0,tags:["samtykkel"],keywords:["datatables","tables","grids","markdown","multimarkdown","jquery plugins"],last_updated:"Nov 24, 2022",hide_table_of_contents:!0},k=void 0,i={unversionedId:"om/samtykke",id:"om/samtykke",title:"Samtykke",description:"Skatteetaten tilbyr samtykkebasert datauthenting basert p\xe5 Altinn sin l\xf8sning for digitalt samtykke.",source:"@site/docs/om/samtykke.md",sourceDirName:"om",slug:"/samtykke",permalink:"/api-dokumentasjon/samtykke",draft:!1,editUrl:"https://github.com/Skatteetaten/api-dokumentasjon/tree/gh-pages/docs/om/samtykke.md",tags:[{label:"samtykkel",permalink:"/api-dokumentasjon/tags/samtykkel"}],version:"current",frontMatter:{title:"Samtykke",slug:"/samtykke",folder:"om",sidebar:"mydoc_sidebar",datatable:!0,tags:["samtykkel"],keywords:["datatables","tables","grids","markdown","multimarkdown","jquery plugins"],last_updated:"Nov 24, 2022",hide_table_of_contents:!0},sidebar:"docs",previous:{title:"Rettighetspakker",permalink:"/api-dokumentasjon/rettighetspakker"},next:{title:"Sikkerhet",permalink:"/api-dokumentasjon/sikkerhet"}},s={},m=[{value:"Samtykke",id:"samtykke",level:2},{value:"Tjenester med st\xf8tte for samtykke",id:"tjenester-med-st\xf8tte-for-samtykke",level:2},{value:"Skatteetaten sine krav ifm redirect til Altinn sin samtykketjeneste",id:"skatteetaten-sine-krav-ifm-redirect-til-altinn-sin-samtykketjeneste",level:2},{value:"Tjenesteparametre",id:"tjenesteparametre",level:3},{value:"Krav om kontroll av samtykke",id:"krav-om-kontroll-av-samtykke",level:3},{value:"Restriksjon p\xe5 bruk av iFrames",id:"restriksjon-p\xe5-bruk-av-iframes",level:3},{value:"Veksle inn authcode",id:"veksle-inn-authcode",level:2},{value:"Headerinformasjon",id:"headerinformasjon",level:2}],o={toc:m};function d(e){let{components:t,...l}=e;return(0,r.kt)("wrapper",(0,n.Z)({},o,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("summary",null,"Skatteetaten tilbyr samtykkebasert datauthenting basert p\xe5 Altinn sin l\xf8sning for digitalt samtykke."),(0,r.kt)("h2",{id:"samtykke"},"Samtykke"),(0,r.kt)("p",null,"Samtykke gis via ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/utviklingsguider/samtykke/"},"samtykkel\xf8sningen til Altinn")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"illustrasjon av samtykkeprosessen",src:a(282).Z,width:"1249",height:"676"})),(0,r.kt)("p",null,"For \xe5 bruke l\xf8sningen m\xe5 virksomheten f\xf8rst redirecte skattepliktig til samtykkel\xf8sningen til Altinn. Dersom skattepliktig samtykker til at \xf8nskede data kan utleveres til virksomheten oppretter Altinn et samtykke (en representasjon av hva som er avtalt mellom Datakonsument og Skattepliktig). Virksomheten kan s\xe5 hente data fra Skatteetatens datatjenester. Samtykket m\xe5 sendes med dataforesp\xf8rselen og blir kontrollert av Skatteetaten. "),(0,r.kt)("h2",{id:"tjenester-med-st\xf8tte-for-samtykke"},"Tjenester med st\xf8tte for samtykke"),(0,r.kt)("p",null,"Samtykke fra skatteyter:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/inntekt"},"Inntekt API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/spesifisertsummertskattegrunnlag"},"Spesifisert summert skattegrunnlag API"))),(0,r.kt)("p",null,"Samtykke fra virksomhet"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/arbeidsgiveravgift"},"Arbeidsgiveravgift API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/mva_meldingsopplysning"},"Mva meldingsopplysning API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/oppdragutenlandskevirksomheter"},"Oppdrag utenlanske virksomheter API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/restanser"},"Restanser API"))),(0,r.kt)("p",null,"De spesifikke tjenestekodene som skal benyttes ligger dokumentert pr. api."),(0,r.kt)("h2",{id:"skatteetaten-sine-krav-ifm-redirect-til-altinn-sin-samtykketjeneste"},"Skatteetaten sine krav ifm redirect til Altinn sin samtykketjeneste"),(0,r.kt)("p",null,"For \xe5 starte en samtykkeinng\xe5else m\xe5 man benytte Altinn's l\xf8sning for samtykker.\nNedenfor er en oversikt over hvilke parametre/verdier som m\xe5 benyttes for \xe5 etablere samtykke for bruk av Skatteetaten sine datatjenester."),(0,r.kt)("p",null,"For full oversikt over alle parametre som m\xe5/kan settes, se ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/guides/samtykke/datakonsument/be-om-samtykke/#url"},"Altinn: be om samtykke")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"forklaring"),(0,r.kt)("th",{parentName:"tr",align:null},"eksempelverdi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Resources"),(0,r.kt)("td",{parentName:"tr",align:null},"Punktum separert liste med ID_VERSJON for data tjenester man \xf8nsker samtykke for."),(0,r.kt)("td",{parentName:"tr",align:null},"4628_210607.4804_210607")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CoveredBy"),(0,r.kt)("td",{parentName:"tr",align:null},"Orgnummer for virksomhet. M\xe5 matche orgnummer til autentisert virksomhet"),(0,r.kt)("td",{parentName:"tr",align:null},"123456789")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"HandledBy"),(0,r.kt)("td",{parentName:"tr",align:null},"Orgnummer for leverand\xf8ren, dersom tilgangen er delegert"),(0,r.kt)("td",{parentName:"tr",align:null},"123456789")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RedirectURL"),(0,r.kt)("td",{parentName:"tr",align:null},"Url-encoded url som sluttbruker skal redirectes til etter inng\xe5tt samtykke"),(0,r.kt)("td",{parentName:"tr",align:null},"https%3A%2F%2F",(0,r.kt)("a",{parentName:"td",href:"http://www.virksomhet.no"},"www.virksomhet.no"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ValidToDate"),(0,r.kt)("td",{parentName:"tr",align:null},"Kan maksimalt v\xe6re 10 dager frem i tid. Skatteetaten vil avvise samtykker med gyldighetsperioder lengre perioder enn 10 dager (selv om samtykket benyttes innen 10 dager)"),(0,r.kt)("td",{parentName:"tr",align:null},"2017-04-30T10:30:00Z")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RequestMessage (tidl. DelegationContext)"),(0,r.kt)("td",{parentName:"tr",align:null},"I ny samtykkel\xf8sning skal denne ikke fylles ut, tekstene er definert i malene"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607_fraOgMed"),(0,r.kt)("td",{parentName:"tr",align:null},"Parameter for Inntekt"),(0,r.kt)("td",{parentName:"tr",align:null},"2018-03")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607_tilOgMed"),(0,r.kt)("td",{parentName:"tr",align:null},"Parameter for Inntekt"),(0,r.kt)("td",{parentName:"tr",align:null},"2018-06")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4628_210607_inntektsaar"),(0,r.kt)("td",{parentName:"tr",align:null},"Parameter for Skattegrunnlag"),(0,r.kt)("td",{parentName:"tr",align:null},"2017")))),(0,r.kt)("h3",{id:"tjenesteparametre"},"Tjenesteparametre"),(0,r.kt)("p",null,"N\xe5r man starter samtykkeinng\xe5elsen m\xe5 man ha med tjenestespesifikke parametre for de tjenestene man vil ha samtykke for. "),(0,r.kt)("p",null,"Eksempler for SBL:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Resource"),(0,r.kt)("th",{parentName:"tr",align:null},"obligatoriske parametere"),(0,r.kt)("th",{parentName:"tr",align:null},"forklaring"),(0,r.kt)("th",{parentName:"tr",align:null},"eksempel"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4628_210607"),(0,r.kt)("td",{parentName:"tr",align:null},"4628_210607_inntektsaar"),(0,r.kt)("td",{parentName:"tr",align:null},"inntektsaar det skal hentes skattedata for"),(0,r.kt)("td",{parentName:"tr",align:null},"&4628_210607_inntektsaar=2017")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607"),(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607_fraOgMed"),(0,r.kt)("td",{parentName:"tr",align:null},"startm\xe5ned det skal hentes inntektsopplysninger for"),(0,r.kt)("td",{parentName:"tr",align:null},"&4804_210607_fraOgMed=2018-08")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607"),(0,r.kt)("td",{parentName:"tr",align:null},"4804_210607_fraOgMed"),(0,r.kt)("td",{parentName:"tr",align:null},"sluttm\xe5ned det skal hentes inntektsopplysninger for"),(0,r.kt)("td",{parentName:"tr",align:null},"&4804_210607_tilOgMed=2018-10")))),(0,r.kt)("h3",{id:"krav-om-kontroll-av-samtykke"},"Krav om kontroll av samtykke"),(0,r.kt)("p",null,"Hvis virksomheten ikke vet med sikkerhet hvem som har samtykket skal virksomheten kontrollere hvem samtykketoken gjelder for ",(0,r.kt)("em",{parentName:"p"},"f\xf8r")," sp\xf8rring mot Datasamarbeid API utf\xf8res. Dette er spesielt aktuelt i tilfeller der det gis flere samtykker i samme saksflyt (for eksempel at flere personer s\xf8ker l\xe5n sammen). "),(0,r.kt)("p",null,"Se ",(0,r.kt)("a",{parentName:"p",href:"../spoersmaalogsvar/samtykketokenfeil.md"},"Sp\xf8rsm\xe5l og svar")," for hvordan man kan kontrollere samtykketoken, og mulige \xe5rsaker til problemet."),(0,r.kt)("h3",{id:"restriksjon-p\xe5-bruk-av-iframes"},"Restriksjon p\xe5 bruk av iFrames"),(0,r.kt)("p",null,"Samtykkedialogen kan ikke innpakkes i en iFrame eller annen branding som er egnet til \xe5 utydeliggj\xf8re domenet samtykkedialogen foreg\xe5r p\xe5 (som er altinn + idporten)."),(0,r.kt)("p",null,"Dette er begrunnet med et potensielt misbruksscenario beskrevet i ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-10.13"},"OAuth2-spesifikasjonen")," (clickjacking)"),(0,r.kt)("h2",{id:"veksle-inn-authcode"},"Veksle inn authcode"),(0,r.kt)("p",null,"Se ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/guides/samtykke/datakonsument/hente-token/"},"Altinn: veksle inn autorisasjonskode i token")),(0,r.kt)("h2",{id:"headerinformasjon"},"Headerinformasjon"),(0,r.kt)("p",null,"For virksomheter som benytter samtykke m\xe5 Altinn samtykketoken settes i header i request til Skatteetaten sine datatjenester. "),(0,r.kt)("p",null,"Verdien i denne headeren skal v\xe6re et Json Web Token (JWT) signert av Altinn. For informasjon rundt hvordan man skaffer et slikt token, sjekk ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/guides/samtykke/datakonsument/hente-token/"},"Altinn: hente token")),(0,r.kt)("p",null,"Det er ikke n\xf8dvendig for virksomheten \xe5 lese samtykketoken eller sette seg inn i tokenformatet. For full dokumentasjon av tokenformat se\n",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/guides/samtykke/datakilde/bruk-av-token/"},"Altinn: tokenformat")," "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"header"),(0,r.kt)("th",{parentName:"tr",align:null},"forklaring"),(0,r.kt)("th",{parentName:"tr",align:null},"eksempelverdi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AltinnSamtykke"),(0,r.kt)("td",{parentName:"tr",align:null},"Base64 encoded JWT samtykketoken fra Altinn"),(0,r.kt)("td",{parentName:"tr",align:null},"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkthUGxpMFJUdVVUcl9yUXJWSmhzQkNXQS0yayJ9.eyJTZXJ2aWNlQ29kZXMiOiI0NjI4LDEiLCJBdXRob3JpemF0aW9uQ29kZSI6IjE1MzM0ZTcxLTVhMzEtNDE0Ny05MjA4LTNkYTFlZDYwNTY0OSIsIk9mZmVyZWRCeSI6IjA1MDg4MDAwMTEyIiwiQ292ZXJlZEJ5IjoiOTEwNTE0NDU4IiwiRGVsZWdhdGVkRGF0ZSI6IjE2LjAyLjIwMTcgMTc6MTc6MDYiLCJWYWxpZFRvRGF0ZSI6IjAxLjAxLjIwMTggMjM6NTk6NTkiLCJpc3MiOiJhbHRpbm4ubm8iLCJleHAiOjE0ODgzMDQzMDcsIm5iZiI6MTQ4ODMwNDI3N30.signatur_fjernet")))),(0,r.kt)("p",null,"Samtykketoken er base64-encodet og signert n\xe5r det hentes fra Altinn sin datatjeneste. Det er bare gyldig i 30 sekunder, men man kan hente nytt token basert p\xe5 authcoden s\xe5 ofte man vil. "),(0,r.kt)("p",null,"Samtykketoken er et JWT token og det finnes gode online verkt\xf8y for \xe5 lese tokens, f.eks. ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io"},"jwt.io")))}d.isMDXComponent=!0},282:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/samtykke-30129d9cf8a5f23caed1f5596aa7d6e4.png"}}]);