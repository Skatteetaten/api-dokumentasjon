"use strict";(self.webpackChunkapi_dokumentasjon=self.webpackChunkapi_dokumentasjon||[]).push([[135],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},k=Object.keys(e);for(a=0;a<k.length;a++)n=k[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(e);for(a=0;a<k.length;a++)n=k[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),o=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=o(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,k=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=o(n),u=r,g=d["".concat(l,".").concat(u)]||d[u]||p[u]||k;return n?a.createElement(g,i(i({ref:t},m),{},{components:n})):a.createElement(g,i({ref:t},m))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var k=n.length,i=new Array(k);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var o=2;o<k;o++)i[o]=n[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2761:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>k,metadata:()=>s,toc:()=>o});var a=n(7462),r=(n(7294),n(3905));const k={title:"Samtykke",slug:"/samtykke",folder:"om",sidebar:"mydoc_sidebar",datatable:!0,tags:["Samtykke"],keywords:["datatables","tables","grids","markdown","multimarkdown","jquery plugins"],last_updated:"Nov 24, 2022",hide_table_of_contents:!0},i=void 0,s={unversionedId:"om/samtykke",id:"om/samtykke",title:"Samtykke",description:"Skatteetaten tilbyr samtykkebasert datauthenting basert p\xe5 Altinn sin l\xf8sning for digitalt samtykke.",source:"@site/docs/om/samtykke.md",sourceDirName:"om",slug:"/samtykke",permalink:"/api-dokumentasjon/samtykke",draft:!1,editUrl:"https://github.com/Skatteetaten/api-dokumentasjon/tree/gh-pages/docs/om/samtykke.md",tags:[{label:"Samtykke",permalink:"/api-dokumentasjon/tags/samtykke"}],version:"current",frontMatter:{title:"Samtykke",slug:"/samtykke",folder:"om",sidebar:"mydoc_sidebar",datatable:!0,tags:["Samtykke"],keywords:["datatables","tables","grids","markdown","multimarkdown","jquery plugins"],last_updated:"Nov 24, 2022",hide_table_of_contents:!0},sidebar:"docs",previous:{title:"Rettighetspakker",permalink:"/api-dokumentasjon/rettighetspakker"},next:{title:"Sikkerhet",permalink:"/api-dokumentasjon/sikkerhet"}},l={},o=[{value:"Samtykke",id:"samtykke",level:2},{value:"F\xe5 tilgang",id:"f\xe5-tilgang",level:3},{value:"Be om samtykke",id:"be-om-samtykke",level:3},{value:"Headereksempel",id:"headereksempel",level:2},{value:"Tjenester med st\xf8tte for samtykke",id:"tjenester-med-st\xf8tte-for-samtykke",level:2}],m={toc:o},d="wrapper";function p(e){let{components:t,...k}=e;return(0,r.kt)(d,(0,a.Z)({},m,k,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("summary",null,"Skatteetaten tilbyr samtykkebasert datauthenting basert p\xe5 Altinn sin l\xf8sning for digitalt samtykke."),(0,r.kt)("h2",{id:"samtykke"},"Samtykke"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"illustrasjon av samtykkeprosessen",src:n(7938).Z,width:"1249",height:"676"})),(0,r.kt)("h3",{id:"f\xe5-tilgang"},"F\xe5 tilgang"),(0,r.kt)("p",null,"F\xf8r du som konsument kan benytte Skatteetaten API'er som krever samtykke eller fullmakt m\xe5 du f\xe5 tilgang til Altinn's samtykkel\xf8sning. Altinn har beskrevet det som skal til for \xe5 ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/utviklingsguider/samtykke/datakonsument/komme-i-gang"},"komme i gang med samtykke"),". Skatteetaten er her datakilden og har p\xe5 forh\xe5nd opprettet tjenestekoder og tjenesteutgavekoder for api'ene. N\xe6rmere informasjon om dette finner du i api-dokumentasjonen. Merk at Skatteetaten ikke benytter tjenesteeierstyrt rettighetsregister."),(0,r.kt)("h3",{id:"be-om-samtykke"},"Be om samtykke"),(0,r.kt)("p",null,"N\xe5r du har f\xe5tt tilgang til Altinn's Samtykkel\xf8sning og API'et til Skatteetaten kan det ",(0,r.kt)("a",{parentName:"p",href:"https://altinn.github.io/docs/utviklingsguider/samtykke/datakonsument/be-om-samtykke"},"bes om samtykke"),". Skatteetaten st\xf8tter kun ",(0,r.kt)("em",{parentName:"p"},"Forh\xe5ndsregistrerte samtykkeforesp\xf8rsler")," og det er heller ikke mulig \xe5 overstyre de forh\xe5ndsdefinerte tekstene. ",(0,r.kt)("em",{parentName:"p"},"Request Message")," skal derfor ikke benyttes i foresp\xf8rselen. "),(0,r.kt)("p",null,"Den overordnetete flyten for samtykkedialogen blir da som f\xf8lger:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Bruker logger seg p\xe5 nettl\xf8sningen for \xe5 f.eks. s\xf8ke om l\xe5n eller se sine Krav og betalinger. Konsumenter m\xe5 dermed ha et samtykke eller fullmakt for \xe5 innhente opplysninger p\xe5 vegne av brukeren. "),(0,r.kt)("li",{parentName:"ol"},"Konsument innhenter samtykket ved \xe5 sende en samtykkeforesp\xf8rsel for bruker til Altinn med ",(0,r.kt)("em",{parentName:"li"},"ServiceCode")," og ",(0,r.kt)("em",{parentName:"li"},"ServiceCodeEdition")," for de aktuelle tjenestene og mottar en ",(0,r.kt)("em",{parentName:"li"},"AuthorizationCode"),". Dersom det allerede foreligger et gyldig samtykke som er innenfor utl\xf8pstiden (f.eks. 90 dager for ",(0,r.kt)("em",{parentName:"li"},"Krav og betalinger"),"), fortsetter flyten i steg 6.  "),(0,r.kt)("li",{parentName:"ol"},"Konsument sender deretter brukeren til samtykkesiden hos Altinn med ",(0,r.kt)("em",{parentName:"li"},"Authorization Code")," fra samtykkeforesp\xf8rselen og en ",(0,r.kt)("em",{parentName:"li"},"RedirectURL"),", som er en lenke til siden brukeren skal sendes tilbake til etter at samtykket er gitt."),(0,r.kt)("li",{parentName:"ol"},"Brukeren blir presentert for samtykkesiden som inneholder en beskrivelse av hva det skal gis samtykke til. Det er Skatteetaten som har definert dette innholdet."),(0,r.kt)("li",{parentName:"ol"},"Brukeren gir samtykke og sendes tilbake til konsumentens nettsider p\xe5 ",(0,r.kt)("em",{parentName:"li"},"Redirect URL'en")," som ble oppgitt."),(0,r.kt)("li",{parentName:"ol"},"Konsument ",(0,r.kt)("a",{parentName:"li",href:"https://altinn.github.io/docs/utviklingsguider/samtykke/datakonsument/hente-token"},"henter et Samtykketoken")," fra Altinn ved bruk av ",(0,r.kt)("em",{parentName:"li"},"Authorization Code"),". Samtykketokenet har vanligvis utl\xf8pstid p\xe5 30 sekunder, men kan innhentes p\xe5 nytt med samme ",(0,r.kt)("em",{parentName:"li"},"AuthorizationCode")," s\xe5 lenge samtykket fortsatt er gyldig."),(0,r.kt)("li",{parentName:"ol"},"Konsument sender med samtykketokenet i foresp\xf8rslene til api'et gjennom \xe5 sette en HTTP-headerverdi: ",(0,r.kt)("inlineCode",{parentName:"li"},"AltinnSamtykke: <samtykketoken>"),". Foresp\xf8rselen m\xe5 ogs\xe5 inneholde et ",(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/sikkerhet"},"Maskinporten-token"),"."),(0,r.kt)("li",{parentName:"ol"},"Skatteetaten sjekker Maskinporten- og Samtykketoken og utleverer dataene.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"Restriksjon p\xe5 bruk av iFrames"),"\nSamtykkedialogen kan ikke innpakkes i en iFrame eller annen branding som er egnet til \xe5 utydeliggj\xf8re domenet samtykkedialogen foreg\xe5r p\xe5 (som er altinn + idporten)."),(0,r.kt)("p",{parentName:"blockquote"},"Dette er begrunnet med et potensielt misbruksscenario beskrevet i ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-10.13"},"OAuth2-spesifikasjonen")," (clickjacking)")),(0,r.kt)("h2",{id:"headereksempel"},"Headereksempel"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"header"),(0,r.kt)("th",{parentName:"tr",align:null},"forklaring"),(0,r.kt)("th",{parentName:"tr",align:null},"eksempelverdi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AltinnSamtykke"),(0,r.kt)("td",{parentName:"tr",align:null},"Base64 encoded JWT samtykketoken fra Altinn"),(0,r.kt)("td",{parentName:"tr",align:null},"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkthUGxpMFJUdVVUcl9yUXJWSmhzQkNXQS0yayJ9.eyJTZXJ2aWNlQ29kZXMiOiI0NjI4LDEiLCJBdXRob3JpemF0aW9uQ29kZSI6IjE1MzM0ZTcxLTVhMzEtNDE0Ny05MjA4LTNkYTFlZDYwNTY0OSIsIk9mZmVyZWRCeSI6IjA1MDg4MDAwMTEyIiwiQ292ZXJlZEJ5IjoiOTEwNTE0NDU4IiwiRGVsZWdhdGVkRGF0ZSI6IjE2LjAyLjIwMTcgMTc6MTc6MDYiLCJWYWxpZFRvRGF0ZSI6IjAxLjAxLjIwMTggMjM6NTk6NTkiLCJpc3MiOiJhbHRpbm4ubm8iLCJleHAiOjE0ODgzMDQzMDcsIm5iZiI6MTQ4ODMwNDI3N30.signatur_fjernet")))),(0,r.kt)("p",null,"Samtykketoken er base64-encodet og signert n\xe5r det hentes fra Altinn sin datatjeneste. "),(0,r.kt)("p",null,"Samtykketoken er et JWT token og det finnes gode online verkt\xf8y for \xe5 lese tokens, f.eks. ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io"},"jwt.io")),(0,r.kt)("h2",{id:"tjenester-med-st\xf8tte-for-samtykke"},"Tjenester med st\xf8tte for samtykke"),(0,r.kt)("p",null,"F\xf8lgende api'er hos Skatteetaten st\xf8tter utlevering gjennom samtykke eller fullmakt. Detaljer om parameterne som er n\xf8dvendig for \xe5 f\xe5 utstedt samtykker eller fullmakt er beskrevet i dokumentasjonen for hvert enkelt api."),(0,r.kt)("p",null,"Samtykke fra skatteyter:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/inntekt"},"Inntekt API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/spesifisertsummertskattegrunnlag"},"Spesifisert summert skattegrunnlag API"))),(0,r.kt)("p",null,"Samtykke fra virksomhet"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/arbeidsgiveravgift"},"Arbeidsgiveravgift API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/mva_meldingsopplysning"},"Mva meldingsopplysning API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/oppdragutenlandskevirksomheter"},"Oppdrag utenlanske virksomheter API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api-dokumentasjon/restanser"},"Restanser API"))))}p.isMDXComponent=!0},7938:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/samtykke-30129d9cf8a5f23caed1f5596aa7d6e4.png"}}]);